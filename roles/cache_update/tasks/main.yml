---
# tasks file for cache_update
- name: Pinging server to update facts cache
  ping:

- name: update /etc/hosts file with current host records
  lineinfile: dest=/etc/hosts
              regexp='.*{{ item }}$'
              line="{{ hostvars[item].ansible_default_ipv4.address }} {{item}}"
              state=present
  when: hostvars[item].ansible_default_ipv4.address is defined
  with_items: groups['all']
